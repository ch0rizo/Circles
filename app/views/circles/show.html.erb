<div class="circle-show-banner">
  <%= cl_image_tag @circle.banner.key %> 
</div>
<div class="circle-show-title">
  <%= cl_image_tag @circle.photo.key, class: "circle-avatar-circle", alt: "circle-avatar" %>
  <div class="circle-show-details">
    <h2><%= @circle.name.upcase %></h2>
    <p><%= @circle.created_at.strftime("STARTED %b %Y") %></p>
    <div class="circle-show-details-private">
      <p><i class="fa-solid fa-user-group"></i><%= @circle.users.count %> MEMBERS</p>
      <% if @circle.private == true %>
        <p><i class="fa-solid fa-circle"></i>PRIVATE</p>
      <% else %>
        <p><i class="fa-regular fa-circle"></i>OPEN</p>
      <% end %>
    </div>
  </div>
</div>

<div class="circle-show-top">
  <%= link_to "<i class='fa-solid fa-arrow-left'></i>".html_safe, root_path %>
  <div class="circle-show-members">
    <h4>Members</h4>
    <% @circle.users.each do |user| %>
      <ul style="list-style: none">
        <li style="font-size: 12px"><%= user.first_name.upcase %> <%= user.last_name.upcase %></li>
      </ul>
    <% end %>
  </div>
  <div class="circle-show-upcoming-events">
    <h2>Upcoming Events:</h2>
    <% if @circle.events.length != 0 %>
      <% @circle.events.each do |event| %>
        <% if event.start_date.future? %>
          <ul>
            <li><%= event.title %></li> 
          </ul>
        <% end %>
      <% end %>
    <% else %>
      <p>You have no upcoming events...</p>
    <% end %>
  </div>
</div>


<div class="chatroom"
  data-controller="circle-chatroom-subscription"
  data-circle-chatroom-subscription-chatroom-id-value="<%= @circle.id %>"
  >
  <h1>#<%= @circle.name %></h1>

  <div class="messages" data-circle-chatroom-subscription-target="messages">
    <% @circle.circle_messages.each do |circle_message| %>
      <%= render "circle_messages/circle_message", circle_message: circle_message %>
    <% end %>
  </div>
  <%= simple_form_for [@circle, @circle_message],
    html: { data: { action: "turbo:submit-end->chatroom-subscription#resetForm" }, class: "d-flex" } do |f|
  %>
    <%= f.input :content,
      label: false,
      placeholder: "Message ##{@circle.name}",
      wrapper_html: {class: "flex-grow-1"}
    %>
    <%= f.submit "Send", class: "btn btn-primary mb-3" %>
  <% end %>
</div>






<h2>Previous Events:</h2>
<% if @circle.events.length != 0 %>
  <% @circle.events.each do |event| %>
    <% unless event.start_date.future? %>
      <ul>
        <li><%= event.title %></li>
      </ul>
    <% end %>
  <% end %>
<% else %>
  <p>No previous events...</p>
<% end %>

<div class="btn btn-primary">
  <%= link_to "Create new Event", new_event_path  %>
</div>

